# 百度地图集成配置说明

## 功能概述

为旅行计划详情页面添加了百度地图功能，支持路线规划。用户可以从旅行计划中的景点选择出发点和终点，查看最优路线。

## 主要功能

### 🗺️ 地图展示
- 使用百度地图JavaScript API GL
- 支持3D地图展示
- 自动标记旅行计划中的所有景点
- 支持地图缩放、拖拽等交互

### 🚗 路线规划
- 从旅行景点中选择出发点和终点
- 调用百度地图路线规划API
- 显示最优路线和路线信息
- 支持清除路线功能

### 📍 景点标记
- 自动提取旅行计划中的景点信息
- 在地图上标记所有景点位置
- 点击标记显示景点详细信息
- 支持信息窗口展示

## 配置步骤

### 1. 获取百度地图API密钥

1. **注册百度地图开放平台账号**
   - 访问 [百度地图开放平台](https://lbsyun.baidu.com/)
   - 注册并登录账号

2. **创建应用**
   - 进入控制台
   - 点击"创建应用"
   - 填写应用信息：
     - 应用名称：旅行规划应用
     - 应用类型：浏览器端
     - 启用服务：JavaScript API

3. **获取API密钥（AK）**
   - 创建应用后，在应用列表中查看AK
   - 复制AK密钥备用

### 2. 配置API密钥

在 `src/components/TravelPlanner/TravelMap.js` 文件中：

```javascript
// 百度地图API密钥 - 请替换为你的实际密钥
const BAIDU_MAP_AK = 'YOUR_BAIDU_MAP_AK'; // 需要替换为实际的百度地图API密钥
```

将 `YOUR_BAIDU_MAP_AK` 替换为你从百度地图开放平台获取的实际API密钥。

### 3. 配置域名白名单

在百度地图开放平台控制台中：
1. 进入你的应用设置
2. 在"IP白名单"中添加你的域名
3. 如果是本地开发，可以添加 `localhost` 和 `127.0.0.1`

## 使用方法

### 1. 查看地图
- 在旅行计划详情页面，地图会自动加载
- 地图会显示旅行计划中的所有景点
- 可以拖拽、缩放地图查看详细信息

### 2. 路线规划
1. **选择出发点**：从下拉列表中选择起始景点
2. **选择终点**：从下拉列表中选择目标景点
3. **规划路线**：点击"🚗 规划路线"按钮
4. **查看结果**：地图会显示路线，下方显示路线信息

### 3. 路线信息
- **距离**：显示总距离
- **预计时间**：显示预计行驶时间
- **路线数**：显示可选路线数量

## 技术实现

### 依赖的百度地图API
- **JavaScript API GL**：主要地图API
- **Geocoder**：地理编码服务
- **DrivingRoute**：驾车路线规划服务

### 数据提取
地图组件会自动从旅行计划中提取景点信息：
- 从 `dailyPlans` 中提取每日活动地点
- 从 `recommendations.attractions` 中提取推荐景点
- 自动去重并生成景点列表

### 地图功能
- **地图初始化**：自动设置地图中心和缩放级别
- **景点标记**：为每个景点添加标记和信息窗口
- **路线绘制**：在地图上绘制规划路线
- **视野调整**：自动调整地图视野以显示完整路线

## 注意事项

### 1. API密钥安全
- 不要将API密钥提交到公共代码仓库
- 建议使用环境变量存储API密钥
- 定期检查和更新API密钥

### 2. 使用限制
- 百度地图API有使用配额限制
- 超出配额后需要付费使用
- 建议合理使用，避免频繁调用

### 3. 网络要求
- 需要网络连接才能加载地图
- 建议在WiFi环境下使用
- 支持HTTPS和HTTP协议

### 4. 浏览器兼容性
- 支持现代浏览器（Chrome、Firefox、Safari、Edge）
- 需要支持WebGL的浏览器
- 移动端浏览器支持良好

## 故障排除

### 1. 地图无法加载
- 检查API密钥是否正确
- 确认域名是否在白名单中
- 检查网络连接是否正常

### 2. 路线规划失败
- 确认地点名称是否正确
- 检查地点是否在百度地图服务范围内
- 确认API配额是否充足

### 3. 景点标记不显示
- 检查景点信息是否完整
- 确认地点名称是否可以被地理编码
- 查看浏览器控制台是否有错误信息

## 扩展功能

### 可能的增强功能
- 支持多种交通方式（公交、步行、骑行）
- 添加实时交通信息
- 支持多点路线规划
- 添加景点评分和评论
- 支持离线地图缓存

## 相关文档

- [百度地图JavaScript API GL文档](https://lbs.baidu.com/index.php?title=jspopularGL)
- [百度地图开放平台](https://lbsyun.baidu.com/)
- [路线规划API文档](https://lbsyun.baidu.com/index.php?title=jspopularGL/guide/route)
