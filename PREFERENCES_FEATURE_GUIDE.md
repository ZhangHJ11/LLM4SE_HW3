# 用户偏好设置功能使用说明

## 功能概述

新增的用户偏好设置功能允许用户保存常用的旅行偏好，并在生成旅行计划时快速应用，让AI更好地了解用户的个性化需求。

## 主要功能

### 1. 偏好设置管理
- **创建偏好设置**：用户可以创建多个偏好设置模板，如"商务旅行"、"家庭度假"、"背包客"等
- **编辑偏好设置**：可以随时修改已保存的偏好设置
- **删除偏好设置**：删除不再需要的偏好设置
- **设置默认偏好**：可以将常用的偏好设置设为默认，自动应用到新计划中

### 2. 偏好设置内容
- **旅行风格**：休闲度假、文化探索、冒险刺激、商务出行、家庭亲子、浪漫蜜月
- **住宿类型**：豪华酒店、商务酒店、精品酒店、民宿、青年旅社、度假村、公寓
- **预算范围**：经济型、舒适型、豪华型、奢华型
- **常用出行人数**：1人、2人、3-4人、5-8人、9人以上
- **活动类型**：文化历史、自然风光、美食体验、购物娱乐、户外运动等
- **季节偏好**：春季、夏季、秋季、冬季
- **饮食偏好**：自定义文本描述
- **特殊需求**：无障碍设施、语言翻译、医疗需求等

### 3. 快速应用功能
- **一键应用**：在创建旅行计划时，可以一键应用已保存的偏好设置
- **智能填充**：偏好设置会自动填充到表单的相应字段中
- **组合应用**：可以将多个偏好设置的信息智能合并

### 4. AI集成
- **个性化推荐**：AI会根据用户的偏好设置生成更个性化的旅行计划
- **智能匹配**：AI会考虑用户的旅行风格、预算范围、活动偏好等因素
- **优化建议**：基于偏好设置提供更精准的景点、餐厅、住宿推荐

## 使用步骤

### 1. 创建偏好设置
1. 在仪表板点击"⚙️ 偏好设置"按钮
2. 点击"➕ 新建偏好设置"
3. 填写偏好设置名称和描述
4. 选择或填写各项偏好信息
5. 点击"💾 保存偏好设置"

### 2. 应用偏好设置
1. 在创建旅行计划页面
2. 在"⚙️ 快速应用偏好设置"区域
3. 点击想要应用的偏好设置按钮
4. 系统会自动填充表单字段
5. 继续填写其他必要信息
6. 生成个性化的旅行计划

### 3. 管理偏好设置
- **设为默认**：点击偏好设置卡片上的"⭐ 设为默认"按钮
- **编辑**：点击"✏️ 编辑"按钮修改偏好设置
- **删除**：点击"🗑️ 删除"按钮删除不需要的偏好设置

## 技术实现

### 数据库设计
- 创建了`user_preferences`表存储用户偏好设置
- 使用JSONB字段存储复杂的偏好数据结构
- 支持行级安全策略，确保数据安全

### 前端组件
- `UserPreferences`组件：偏好设置管理界面
- 集成到`Dashboard`和`TravelPlanForm`中
- 响应式设计，支持移动端使用

### AI服务优化
- 更新了AI提示词模板，包含用户偏好信息
- 根据偏好设置生成更个性化的旅行计划
- 智能匹配用户的旅行风格和需求

## 注意事项

1. **数据安全**：所有偏好设置数据都存储在云端，支持多设备同步
2. **隐私保护**：用户只能访问和管理自己的偏好设置
3. **性能优化**：偏好设置数据会缓存到本地，提高加载速度
4. **兼容性**：新功能完全向后兼容，不影响现有功能的使用

## 未来扩展

- 支持偏好设置的导入/导出功能
- 基于历史旅行计划的智能偏好推荐
- 偏好设置的分享和模板功能
- 更细粒度的偏好设置选项
